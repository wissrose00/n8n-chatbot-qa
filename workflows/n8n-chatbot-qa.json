{
  "name": "n8n-chatbot-qa",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -416,
        -80
      ],
      "id": "58f477df-66ef-450a-8dea-15ecb03f1526",
      "name": "When clicking ‚ÄòExecute workflow‚Äô"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "mode": "url",
          "value": "https://docs.google.com/spreadsheets/d/1GPoz0S11xklZrxClybzPfy0PkEXqSIgpoqTbcCojafc/edit?usp=sharing",
          "__regex": "https:\\/\\/(?:drive|docs)\\.google\\.com(?:\\/.*|)\\/d\\/([0-9a-zA-Z\\-_]+)(?:\\/.*|)"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Trang t√≠nh1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1GPoz0S11xklZrxClybzPfy0PkEXqSIgpoqTbcCojafc/edit#gid=0"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -208,
        -80
      ],
      "id": "4dc0f537-c253-4bdf-9b43-8baf94567330",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "wFewW4wPzjndvnWV",
          "name": "Google Sheets account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Format d·ªØ li·ªáu cho Vector Store\nconst items = [];\n\nfor (const item of $input.all()) {\n  // L·∫•y d·ªØ li·ªáu t·ª´ Google Sheets\n  const question = item.json['C√¢u h·ªèi'] || item.json['cau_hoi'] || item.json['question'];\n  const answer = item.json['C√¢u tr·∫£ l·ªùi'] || item.json['cau_tra_loi'] || item.json['answer'];\n  \n  // Ki·ªÉm tra c√≥ d·ªØ li·ªáu kh√¥ng\n  if (question && answer) {\n    items.push({\n      json: {\n        // pageContent: N·ªôi dung ch√≠nh ƒë·ªÉ embedding\n        pageContent: `C√¢u h·ªèi: ${question}\\nC√¢u tr·∫£ l·ªùi: ${answer}`,\n        \n        // metadata: Th√¥ng tin b·ªï sung (kh√¥ng embedding)\n        metadata: {\n          question: question,\n          answer: answer,\n          source: 'google_sheets'\n        }\n      }\n    });\n  }\n}\n\nreturn items;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        -80
      ],
      "id": "57b74478-0591-40eb-8a07-b7565a1de9cc",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "mode": "insert",
        "memoryKey": {
          "__rl": true,
          "value": "vector_store_key",
          "mode": "list",
          "cachedResultName": "vector_store_key"
        },
        "clearStore": true
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
      "typeVersion": 1.3,
      "position": [
        272,
        -64
      ],
      "id": "898542fe-9761-4a76-8ffc-a3122b1ccd0b",
      "name": "Simple Vector Store"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        112,
        144
      ],
      "id": "ddb190b3-9ed0-480d-a2dd-3abd93dbc4f4",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "diUFMuGPtgguiX2p",
          "name": "n8n free OpenAI API credits"
        }
      }
    },
    {
      "parameters": {
        "public": true,
        "initialMessages": "=Xin ch√†o! üëã T√¥i l√† tr·ª£ l√Ω t∆∞ v·∫•n s·∫£n ph·∫©m. B·∫°n mu·ªën h·ªèi v·ªÅ s·∫£n ph·∫©m n√†o?",
        "options": {
          "inputPlaceholder": "\"Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n...\""
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        -304,
        272
      ],
      "id": "1551e08a-d4f1-4d2f-bf03-f2e2e7344490",
      "name": "When chat message received",
      "webhookId": "0e2a6e91-c5a9-49cf-b1cf-96cda94a1619"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "B·∫°n l√† nh√¢n vi√™n t∆∞ v·∫•n b√°n h√†ng chuy√™n nghi·ªáp v√† th√¢n thi·ªán c·ªßa c·ª≠a h√†ng.\n\nNHI·ªÜM V·ª§:\n- Tr·∫£ l·ªùi c√¢u h·ªèi kh√°ch h√†ng v·ªÅ s·∫£n ph·∫©m, gi√° c·∫£, t√≠nh nƒÉng, khuy·∫øn m√£i\n- S·ª≠ d·ª•ng tool \"search_product_info\" ƒë·ªÉ t√¨m th√¥ng tin ch√≠nh x√°c t·ª´ database\n- ƒê∆∞a ra t∆∞ v·∫•n ph√π h·ª£p v·ªõi nhu c·∫ßu kh√°ch h√†ng\n\nQUY T·∫ÆC QUAN TR·ªåNG:\n1. Lu√¥n s·ª≠ d·ª•ng tool search tr∆∞·ªõc khi tr·∫£ l·ªùi\n2. Ch·ªâ tr·∫£ l·ªùi d·ª±a tr√™n th√¥ng tin c√≥ trong database\n3. N·∫øu kh√¥ng t√¨m th·∫•y th√¥ng tin: \"Xin l·ªói, t√¥i ch∆∞a c√≥ th√¥ng tin v·ªÅ s·∫£n ph·∫©m n√†y. Vui l√≤ng li√™n h·ªá hotline 1900-xxxx ƒë·ªÉ ƒë∆∞·ª£c t∆∞ v·∫•n chi ti·∫øt.\"\n4. KH√îNG ƒë∆∞·ª£c b·ªãa ƒë·∫∑t th√¥ng tin\n5. Tr·∫£ l·ªùi ng·∫Øn g·ªçn, s√∫c t√≠ch (2-3 c√¢u)\n6. Lu√¥n k·∫øt th√∫c b·∫±ng: \"B·∫°n c√≤n th·∫Øc m·∫Øc g√¨ kh√°c kh√¥ng?\"\n\nPHONG C√ÅCH:\n- Th√¢n thi·ªán, nhi·ªát t√¨nh\n- Chuy√™n nghi·ªáp\n- Tr·∫£ l·ªùi b·∫±ng ti·∫øng Vi·ªát t·ª± nhi√™n\n- Kh√¥ng d√πng qu√° nhi·ªÅu emoji\n\nV√ç D·ª§:\nUser: \"Gi√° Samsung A26 bao nhi√™u?\"\nBot: \"Samsung A26 c√≥ gi√° 7 tri·ªáu ƒë·ªìng. B·∫°n c√≤n th·∫Øc m·∫Øc g√¨ kh√°c kh√¥ng?\"",
          "maxIterations": 3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -96,
        272
      ],
      "id": "e159b12c-2b46-40cc-8910-32a1a81f01c1",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -176,
        528
      ],
      "id": "c4441433-b7f3-4168-b75a-d24775a3d779",
      "name": "OpenAI Chat Model",
      "notesInFlow": false,
      "credentials": {
        "openAiApi": {
          "id": "diUFMuGPtgguiX2p",
          "name": "n8n free OpenAI API credits"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        256,
        576
      ],
      "id": "a56e8717-807c-45ed-93fe-c844e52958be",
      "name": "Embeddings OpenAI1",
      "credentials": {
        "openAiApi": {
          "id": "diUFMuGPtgguiX2p",
          "name": "n8n free OpenAI API credits"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "123",
        "memoryKey": {
          "__rl": true,
          "mode": "list",
          "value": "vector_store_key"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
      "typeVersion": 1.3,
      "position": [
        240,
        400
      ],
      "id": "accb66e2-cef1-43f0-8d30-ea985ba7d8b0",
      "name": "Simple Vector Store1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        464,
        144
      ],
      "id": "1708009a-d2a0-4bb5-9b4e-840af48a0e34",
      "name": "Default Data Loader"
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking ‚ÄòExecute workflow‚Äô": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Simple Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Simple Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Vector Store1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI1": {
      "ai_embedding": [
        [
          {
            "node": "Simple Vector Store1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Simple Vector Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "executionTimeout": -1,
    "availableInMCP": false
  },
  "versionId": "502ea8e4-c02c-4db4-831a-4de43315801f",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "9e926efcceb4692c16f8c5dd9c72894a04b529e0b989ded67d1e08fdb92c31bc"
  },
  "id": "3DzxFB4ZFuqWR3qQ",
  "tags": []
}